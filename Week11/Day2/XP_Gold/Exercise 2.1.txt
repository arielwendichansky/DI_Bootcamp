WITH ACTOR AS
	(SELECT M.MOVIE_ID,
			M.TITLE,
			EXTRACT(YEAR FROM M.RELEASE_DATE)AS YEAR,
			P.PERSON_NAME AS ACTOR_NAME,
			ROW_NUMBER() OVER (PARTITION BY P.PERSON_NAME ORDER BY M.RELEASE_DATE ASC) AS RN
		FROM MOVIES.MOVIE AS M
		JOIN MOVIES.MOVIE_CAST AS MC ON M.MOVIE_ID = MC.MOVIE_ID
		JOIN MOVIES.PERSON AS P ON MC.PERSON_ID = P.PERSON_ID
		ORDER BY 3 ASC)
SELECT DISTINCT(ACTOR_NAME),
	FIRST_VALUE(TITLE) OVER (PARTITION BY ACTOR_NAME ORDER BY YEAR) AS FIRST_MOVIE_TITLE,
	FIRST_VALUE(YEAR) OVER (PARTITION BY ACTOR_NAME ORDER BY YEAR) AS FIRST_MOVIE_YEAR,
	LAST_VALUE(title) OVER (PARTITION BY actor_name ORDER BY year
		ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_movie,
    LAST_VALUE(year) OVER (PARTITION BY actor_name ORDER BY year
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_release_date
																																																																																																																																																																																																													
FROM ACTOR

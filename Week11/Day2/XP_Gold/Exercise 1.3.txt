WITH RANKING AS
	(SELECT M.MOVIE_ID,
	 		M.Title,
			G.GENRE_NAME,
			M.REVENUE,
			EXTRACT(YEAR FROM M.RELEASE_DATE) AS YEAR
		FROM MOVIES.MOVIE AS M
		JOIN MOVIES.MOVIE_GENRES AS MG ON M.MOVIE_ID = MG.MOVIE_ID
		JOIN MOVIES.GENRE AS G ON MG.GENRE_ID = G.GENRE_ID)
SELECT GENRE_NAME,
	TITLE,
	REVENUE,
	ROW_NUMBER() OVER (PARTITION BY GENRE_NAME ORDER BY REVENUE DESC) AS RowNum,
	RANK() OVER (PARTITION BY GENRE_NAME ORDER BY REVENUE DESC) AS Rank,
	DENSE_RANK() OVER (PARTITION BY GENRE_NAME ORDER BY REVENUE DESC) AS DenseRank
FROM RANKING
ORDER BY 1,3 DESC;

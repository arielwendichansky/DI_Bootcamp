WITH LEAD_MOVIE AS
	(SELECT M.MOVIE_ID,
			M.TITLE,
			M.BUDGET,
			M.RELEASE_DATE,
	 		LAG (M.BUDGET)OVER(ORDER BY M.RELEASE_DATE) AS PREVIOUS_BUDGET,
			LEAD(M.BUDGET)OVER(ORDER BY M.RELEASE_DATE) AS NEXT_BUDGET
		FROM MOVIES.MOVIE AS M
		ORDER BY 4)
SELECT 
	TITLE,
	RELEASE_DATE,
	BUDGET,
	PREVIOUS_BUDGET,
	NEXT_BUDGET
FROM 
	LEAD_MOVIE
WHERE
	 BUDGET > PREVIOUS_BUDGET AND
	 BUDGET < NEXT_BUDGET;
	 

